import{S as H}from"./EntryFile-BphKqlzn.js";/* empty css              */import{C as F}from"./Config-BIytIw62.js";let C=()=>{let e=document.getElementById("BranchNameId");const a=localStorage.getItem("BranchName").replace("BranOrders","");e!==null&&(e.innerHTML=a);let l=document.getElementById("BranchDisplay");l&&(l.textContent=a)};const p="binV4",B="Custom/Cleaning/Branch/Order/NewOrderV1/RowSettlement",h="Custom/Cleaning/Branch/Order/NewOrderV1/Settlement",S={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},j={routePath:p,GetUrl:B,PostUrl:h,localStorageKeys:S};let y=async()=>{let t=O({inGetKey:"OrderNumber"}),e=localStorage.getItem("BranchName"),n=`/${j.GetUrl}/${t}/${e}`;return await fetch(n)},O=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)};const v=(t,e,n=!1)=>{let a=document.getElementById(t);a&&(n?a.innerHTML=e:a.value=e)},N=({inData:t})=>{[{id:"OrderAmountId",value:t.Rate,isInnerHTML:!0},{id:"OrderNumberId",value:t.OrderNumber,isInnerHTML:!0},{id:"OrderInfoCustomerNameId",value:t.CustomerName},{id:"BranchNameId",value:t.BranchName},{id:"BranchDisplay",value:t.BranchName},{id:"OrderDate",value:t.Date},{id:"OrderInfoCustomerMobileId",value:t.Mobile},{id:"CgstAmountId",value:t.CGST},{id:"SgstAmountId",value:t.SGST},{id:"NettAmountId",value:t.TotalAmt},{id:"RoundOffId",value:t.RoundOffAmt},{id:"TotalNetAmountId",value:t.RoundedTotal,isInnerHTML:!0}].forEach(({id:n,value:a,isInnerHTML:l})=>v(n,a,l))},d=(t,e)=>{let n=document.getElementById(t);n&&(n.value=e)},D=({inData:t})=>{if(!t.CheckOutData)return"";let{CashAmount:e,UPIAmount:n,CardAmount:a,DiscountPer:l}=t.CheckOutData;d("CashAmountId",e),d("UPIAmountId",n),d("CardAmountId",a),d("DiscountPerId",l)},E=({inData:t})=>{console.log("inData:",t),N({inData:t}),D({inData:t})},R=async({inFromFetch:t})=>{if(t.status===200){let e=await t.json();E({inData:e})}t.status};let U=async()=>{{let t=await y();R({inFromFetch:t})}},P=()=>{U()};const $=()=>{P()};let T=async({inSettlementData:t})=>{let e=localStorage.getItem("BranchName"),n=t.inDataToUpdate,a=`/${j.PostUrl}/${t.MainRowPK}/${e}`,l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return await(await fetch(a,l)).json()},w=()=>{b({inGetKey:"BranchName"});let t={};t.DiscountAmount=parseFloat(G())||0,t.CGST=parseFloat(k())||0,t.SGST=parseFloat(M())||0;let e={};return e.MainRowPK=Q(),e.InsertKey="CheckOutData",e.inDataToUpdate={},e.inDataToUpdate.RoundOff=parseFloat(Z())||0,e.inDataToUpdate.CashAmount=parseInt(K())||0,e.inDataToUpdate.CardAmount=parseInt(q())||0,e.inDataToUpdate.UPIAmount=parseInt(J())||0,e.inDataToUpdate.DiscountPer=parseInt(x())||0,e.inDataToUpdate.GstData=t,e},b=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)},k=()=>document.getElementById("CgstAmountId").value.trim(),M=()=>document.getElementById("SgstAmountId").value.trim(),G=()=>document.getElementById("DiscountAmountId").value.trim(),x=()=>document.getElementById("DiscountPerId").value.trim(),K=()=>document.getElementById("CashAmountId").value.trim(),q=()=>document.getElementById("CardAmountId").value.trim(),J=()=>document.getElementById("UPIAmountId").value.trim(),Q=()=>document.getElementById("OrderNumberId").innerHTML.trim(),Z=()=>document.getElementById("RoundOffId").value.trim();const r=(t,e=!1)=>{let n=document.getElementById(t);return n?e?n.innerHTML.trim():n.value.trim():0},i=t=>document.getElementById(t),z=()=>{let t=parseInt(r("CashAmountId"))||0,e=parseInt(r("CardAmountId"))||0,n=parseInt(r("UPIAmountId"))||0,a=parseFloat(r("RoundOffId"))||0,l=parseFloat(r("DiscountPerId"))||0,o=parseFloat(r("NettAmountId"))||0,u=t+e+n,m=i("DiscountPerId");return m.classList.remove("is-invalid"),l>10?(m.focus(),m.classList.add("is-invalid"),!1):W()?u!==o+a?(!A("CashAmountId",t)||!A("CardAmountId",e)||!A("UPIAmountId",n)||e>0&&n>0&&f("CashAmountId"),!1):!0:!1},W=()=>{let t=parseFloat(r("NettAmountId"))||0,e=parseFloat(r("RoundOffId"))||0,n=parseInt(r("CashAmountId"))||0,a=parseInt(r("CardAmountId"))||0,l=parseInt(r("UPIAmountId"))||0;if(n+a+l<t+e){let u=i("AmountCheckAlert");return u.classList.remove("d-none"),u.classList.add("show"),!1}return!0},A=(t,e)=>e===0?(f(t),!1):(X(t),!0),f=t=>{let e=i(t);e.focus(),e.classList.add("is-invalid")},X=t=>{let e=i(t);e.classList.contains("is-invalid")&&(e.classList.remove("is-invalid"),e.classList.add("is-valid"))};let Y=({inFromFetch:t})=>{t&&Swal.fire({title:"Settlement Success",confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&_()})},_=()=>{const t=F.urls.SaveButtonId.redirectToUrl,e=new URL(window.location.href);let n=new URL(t,e);window.location.href=n.href},tt=async()=>{if(z()){let t=w(),e=await T({inSettlementData:t});Y({inFromFetch:e})}};const et=()=>{(()=>{var n=document.querySelector("#AmountCheckAlert .close");n.addEventListener("click",()=>{document.getElementById("AmountCheckAlert").style.display="none"})})();let e=document.getElementById("SaveButtonId");e!==null&&e.addEventListener("click",tt)};let L=document.getElementById("DiscountPerId"),nt=()=>{L.addEventListener("keyup",at)};const at=lt(()=>ot());function lt(t,e=300){let n;return(...a)=>{clearTimeout(n),n=setTimeout(()=>{t.apply(this,a)},e)}}function ot(){let t=g(),e=document.getElementById("DiscountAmountId");e.value=(t*L.value/100).toFixed(2),Vt({inCgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),At({inSgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),rt()}let rt=()=>{let t=g(),e=document.getElementById("DiscountAmountId"),n=t-e.value,a=st(),l=It();it({inNettAmountId:parseFloat(n)+parseFloat(a)+parseFloat(l)});let o=parseFloat(ut());ct({inRoundOffId:(Math.round(o)-o).toFixed(2)});let u=parseFloat(mt()),m=o+u;dt({inTotalNetAmountId:m})},ut=()=>document.getElementById("NettAmountId").value.trim(),mt=()=>document.getElementById("RoundOffId").value.trim(),dt=({inTotalNetAmountId:t})=>{let n=document.getElementById("TotalNetAmountId");n.innerHTML=t},ct=({inRoundOffId:t})=>{let n=document.getElementById("RoundOffId");n.value=t},st=()=>document.getElementById("SgstAmountId").value.trim(),It=()=>document.getElementById("CgstAmountId").value.trim(),it=({inNettAmountId:t})=>{let n=document.getElementById("NettAmountId");n.value=t.toFixed(2)},At=({inSgstAmountId:t})=>{let n=document.getElementById("SgstAmountId");n.value=t},Vt=({inCgstAmountId:t})=>{let n=document.getElementById("CgstAmountId");n.value=t},g=()=>document.getElementById("OrderAmountId").innerHTML;const c=t=>{var e;return((e=document.getElementById(t))==null?void 0:e.value)||0},jt=(t,e)=>{let n=document.getElementById(t);n&&(n.value=e)},ft=()=>{let t=parseFloat(c("NettAmountId")),e=parseFloat(c("RoundOffId")),n=parseInt(c("CardAmountId"))||0,a=parseInt(c("UPIAmountId"))||0,l=n+a,o=t+e-l;jt("CashAmountId",o.toFixed(0))},Lt=()=>{let t=document.getElementById("CashAmountButtonId");t!==null&&t.addEventListener("click",ft)},s=t=>{var e;return parseFloat((e=document.getElementById(t))==null?void 0:e.value)||0},gt=(t,e)=>{let n=document.getElementById(t);n&&(n.value=e.toFixed(0))},Ht=()=>{let t=s("NettAmountId"),e=s("RoundOffId"),n=s("CashAmountId"),a=s("UPIAmountId"),l=n+a,o=t+e-l;gt("CardAmountId",o)},Ft=()=>{let t=document.getElementById("CardAmountButtonId");t!==null&&t.addEventListener("click",Ht)},I=t=>{var e;return parseFloat((e=document.getElementById(t))==null?void 0:e.value)||0},Ct=(t,e)=>{let n=document.getElementById(t);n&&(n.value=e.toFixed(0))},pt=()=>{let t=I("NettAmountId"),e=I("RoundOffId"),n=I("CashAmountId"),a=I("CardAmountId"),l=n+a,o=t+e-l;Ct("UPIAmountId",o)},Bt=()=>{let t=document.getElementById("UPIAmountButtonId");t!==null&&t.addEventListener("click",pt)};let ht=()=>{et(),nt(),Lt(),Ft(),Bt()};const V=()=>{C(),$(),ht()},St=()=>{H({inSuccessFunc:V})&&V()};St();
